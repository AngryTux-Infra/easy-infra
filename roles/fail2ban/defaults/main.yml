---
# roles/fail2ban/defaults/main.yml — Valores padrão para a role fail2ban
# Sobrescreva em group_vars ou host_vars conforme necessário

# Namespace de variáveis para controle de acesso/fail2ban
access:
  fail2ban:
    bantime: 604800
    ignoreip: "127.0.0.1/8 ::1"
    findtime: 600
    maxretry: 5
    # Vazio = não define MTA no jail.local (seguro para hosts sem MTA funcional)
    mta: ""
    jails:
      nginx_http_auth: false
      nginx_botsearch: false
      nginx_badbots: false

# Compatibilidade com variáveis legadas (flat)
f2b_bantime: "{{ access.fail2ban.bantime | default(604800) }}"
f2b_ignoreip: "{{ access.fail2ban.ignoreip | default('127.0.0.1/8 ::1', true) }}"
f2b_findtime: "{{ access.fail2ban.findtime | default(600) }}"
f2b_maxretry: "{{ access.fail2ban.maxretry | default(5) }}"
f2b_mta: "{{ access.fail2ban.mta | default('', true) }}"
f2b_jail_nginx_http_auth_enabled: "{{ access.fail2ban.jails.nginx_http_auth | default(false) }}"
f2b_jail_nginx_botsearch_enabled: "{{ access.fail2ban.jails.nginx_botsearch | default(false) }}"
f2b_jail_nginx_badbots_enabled: "{{ access.fail2ban.jails.nginx_badbots | default(false) }}"

# Porta SSH monitorada pelo jail sshd
ssh_port: "{{ ssh.port | default(2222) }}"
