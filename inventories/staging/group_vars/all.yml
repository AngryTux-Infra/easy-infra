---
# group_vars/all.yml — Variáveis globais para o ambiente de staging
# Migrado de .env.example para o padrão Ansible (snake_case)
# staging environment

# ==============================================================================
# Configurações de SSH
# ==============================================================================

ssh:
  # Porta do servidor SSH
  port: 2222

  # Permitir autenticação por senha via SSH (yes/no)
  password_auth: "no"

  # Permitir login direto do root via SSH (yes/no)
  permit_root_login: "no"

  # Grupos com permissão de acesso SSH (AllowGroups)
  allow_groups: "ssh-access"

# ==============================================================================
# Usuário administrador
# ==============================================================================

user:
  admin:
    # Nome do usuário administrador a ser criado no servidor
    name: sysadmin

    # Diretório home do usuário administrador
    home: /home/sysadmin

    # Grupos adicionais para o usuário administrador
    groups:
      - sudo
      - adm

    ssh:
      # Chave pública SSH do usuário administrador
      authorized_key: ""

# ==============================================================================
# Configurações do servidor
# ==============================================================================

# Fuso horário do servidor
server_timezone: UTC

# Hostname do servidor
server_hostname: ""

# ==============================================================================
# Atualizações automáticas
# ==============================================================================

# Habilitar atualizações automáticas de segurança via unattended-upgrades
auto_security_updates: true

# Reiniciar automaticamente após atualizações de kernel (quando necessário)
auto_reboot: false

# E-mail para notificações de atualização automática
notify_email: ""

# ==============================================================================
# Firewall
# ==============================================================================

access:
  firewall:
    # Portas permitidas no firewall (lista)
    # NOTA: porta SSH é gerida pela regra dedicada com rate limiting
    allowed_ports:
      - 80
      - 443

    # Endereços IP ou redes com acesso irrestrito ao firewall (lista)
    allowed_ips: []

    # Named network CIDRs
    networks:
      lan:
        cidr: "192.168.1.0/24"

    # Restringir SSH apenas à LAN
    ssh_restrict_to_lan: true

  # ==============================================================================
  # Fail2ban
  # ==============================================================================

  fail2ban:
    # Tempo de banimento em segundos (1 semana)
    bantime: 604800

    # IPs/redes excluídos do ban (loopback + LAN)
    ignoreip: "127.0.0.1/8 ::1 192.168.1.0/24"

    # Janela de tempo para contagem de falhas em segundos
    findtime: 600

    # Número máximo de tentativas antes do banimento
    maxretry: 5

# ==============================================================================
# APT e pacotes
# ==============================================================================

# Codinome da release do Debian/Ubuntu para repositórios APT externos
apt_release: ""

# ==============================================================================
# Logs
# ==============================================================================

# Diretório onde easy-infra armazena seus próprios logs de execução
log_dir: /var/log/easy-infra
